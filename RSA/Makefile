#
#   make [all]  - makes everything.
#   make TARGET - makes the given target.
#   make clean  - removes all files generated by make.

# Please tweak the following variable definitions as needed by your
# project, except GTEST_HEADERS, which you can use in your own targets
# but shouldn't modify.

CRYPTOLIB_DIR = ../cryptolib

# Where to find user code.
LIB_DIR = .

LIBS = -lgmpxx -lgmp

# Flags passed to the C++ compiler.
CXXFLAGS += -g -Wall -Wextra -pthread 
CXXFLAGS += $(LIBS)

# All tests produced by this Makefile.  Remember to add new tests you
# created to the list.
TESTS = RSA_unittest

MAIN = KeyGen Encrypt Decrypt

HEADERS = $(CRYPTOLIB_DIR)/*.h

# House-keeping build targets.

all : $(MAIN)
tests : $(TESTS)

clean :
	rm -f $(MAIN) $(TESTS) gtest.a gtest_main.a *.o

cryptomath.o : $(CRYPTOLIB_DIR)/cryptomath.cpp
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c $(CRYPTOLIB_DIR)/cryptomath.cpp

%.o : %.cpp
	$(CXX) $(CPPFLAGS) -I$(CRYPTOLIB_DIR) $(CXXFLAGS) -c $<


KeyGen : KeyGen.o cryptomath.o
	$(CXX) $(CPPFLAGS) -I$(CRYPTOLIB_DIR) -o $@ cryptomath.o $(CXXFLAGS) $<

Encrypt : Encrypt.o cryptomath.o
	$(CXX) $(CPPFLAGS) -I$(CRYPTOLIB_DIR) -o $@ cryptomath.o $(CXXFLAGS) $<

Decrypt : Decrypt.o cryptomath.o
	$(CXX) $(CPPFLAGS) -I$(CRYPTOLIB_DIR) -o $@ cryptomath.o $(CXXFLAGS) $<

